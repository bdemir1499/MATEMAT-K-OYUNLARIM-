<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aritmetik Ortalama Macerasƒ±: Sƒ∞BERPUNK VERSƒ∞YON</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- Sƒ∞BERPUNK TEMELƒ∞ --- */
        
        /* CSS Deƒüi≈ükenleri (A√ßƒ±k Mavi Renk Paleti) */
        :root {
            --dark-bg: #0a0a1a;       /* √áok koyu lacivert/siyah */
            --main-neon: #33ccff;    /* Ana Neon: A√ßƒ±k Mavi */
            --secondary-neon: #00ffcc; /* ƒ∞kincil Neon: Siyan/Turkuaz */
            --accent-neon: #f7ff00;   /* Vurgu Neonu: Sarƒ± */
            --danger-neon: #ff3333;   /* Hata Neonu: Kƒ±rmƒ±zƒ± */
            --success-neon: #33ccff;  /* Ba≈üarƒ± Neonu: A√ßƒ±k Mavi */
            --font-color: #33ccff;   /* Ana yazƒ± rengi: A√ßƒ±k Mavi */
        }

        body {
            font-family: 'Roboto Mono', monospace;
            background-color: var(--dark-bg);
            color: var(--font-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            overflow: auto; /* ƒ∞√ßerik ta≈üarsa kaydƒ±rma √ßubuƒüu √ßƒ±ksƒ±n */
        }

        /* --- YANIP S√ñNEN MATEMATƒ∞KSEL SEMBOLLER (NEFES ALMA) --- */
        @keyframes breathingGlow {
            0%, 100% {
                opacity: 0.15;
                text-shadow: 0 0 5px currentColor;
            }
            50% {
                opacity: 0.7;
                text-shadow: 0 0 20px currentColor, 0 0 30px currentColor;
            }
        }

        body::before, body::after {
            position: fixed;
            z-index: -1;
            font-weight: bold;
            animation: breathingGlow 4s infinite ease-in-out;
        }

        /* Sol √ºst semboller */
        body::before {
            content: '\u03A3 \u222B \u03C0 \u221E';
            top: 10%;
            left: 5%;
            font-size: 2.5em;
            color: var(--main-neon);
            animation-duration: 5s;
        }

        /* Saƒü alt semboller */
        body::after {
            content: '\u03B1 \u03B2 \u2248 \u00B1 \u2202';
            bottom: 10%;
            right: 8%;
            font-size: 2em;
            color: var(--secondary-neon);
            animation-duration: 3.5s;
        }

        /* --- OYUN ARAY√úZ√ú --- */
        .game-container {
            width: 100%;
            max-width: 600px;
            background-color: rgba(16, 24, 48, 0.85);
            border: 2px solid var(--main-neon);
            border-radius: 4px; 
            box-shadow: 0 0 20px var(--main-neon), inset 0 0 10px var(--main-neon);
            padding: 25px;
            text-align: center;
            backdrop-filter: blur(3px); 
        }

        h2 {
            color: var(--accent-neon);
            text-shadow: 0 0 10px var(--accent-neon);
            border-bottom: 1px solid var(--main-neon);
            padding-bottom: 10px;
            text-transform: uppercase; 
        }

        /* --- Hƒ∞KAYE ALANI --- */
        .story-box {
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px dashed var(--secondary-neon);
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: left;
            min-height: 100px; /* Hikaye kutusunun minimum y√ºksekliƒüi */
        }
        #story-text {
            font-size: 1.1em;
            line-height: 1.6;
        }
        #data-set {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--danger-neon);
            margin-top: 10px;
            text-align: center;
            text-shadow: 0 0 8px var(--danger-neon);
        }

        /* --- FORM√úL TAHTASI --- */
        .formula-section {
            margin-bottom: 25px;
            border: 1px dashed rgba(255, 255, 255, 0.1);
            padding: 15px 5px;
        }
        
        .formula-title {
            color: var(--secondary-neon);
            font-size: 1.1em;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .formula-board {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px 0;
            font-size: 2.5em;
            font-weight: bold;
            color: var(--accent-neon);
            text-shadow: 0 0 5px var(--accent-neon);
        }
        
        /* Yeni form√ºl satƒ±rlarƒ± */
        .formula-row {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px 0;
            font-size: 1.4em;
            font-weight: bold;
            color: var(--secondary-neon);
            text-shadow: 0 0 3px var(--secondary-neon);
        }
        .formula-row span {
            margin: 0 10px;
        }


        .formula-label {
            margin-right: 15px;
        }

        .fraction {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .fraction-line {
            width: 150px;
            height: 3px;
            background-color: var(--accent-neon);
            box-shadow: 0 0 5px var(--accent-neon);
            margin: 5px 0;
        }

        /* V.T ve V.S Giri≈ü Kutularƒ± */
        .formula-input {
            width: 140px;
            height: 40px;
            font-family: 'Roboto Mono', monospace;
            font-size: 1em;
            text-align: center;
            background-color: #000;
            color: var(--font-color);
            border: 2px solid var(--secondary-neon);
            border-radius: 4px;
            transition: all 0.3s;
        }
        .formula-input:focus {
            border-color: var(--accent-neon);
            box-shadow: 0 0 15px var(--accent-neon);
            outline: none;
        }
        .formula-input[type="text"] {
            cursor: pointer;
            background-color: #111;
        }
        .formula-input::placeholder {
            font-size: 0.6em;
            color: #777;
        }

        /* --- BUTONLAR --- */
        #calculate-btn, #new-game-btn {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            font-weight: bold;
            font-family: 'Roboto Mono', monospace;
            text-transform: uppercase;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        #calculate-btn {
            display: none;
            background-color: var(--success-neon);
            color: var(--dark-bg);
            border: none;
            box-shadow: 0 0 15px var(--success-neon);
            margin-top: 10px;
        }
        #calculate-btn:hover {
            background-color: var(--dark-bg);
            color: var(--success-neon);
            border: 2px solid var(--success-neon);
        }

        #new-game-btn {
            background-color: transparent;
            color: var(--main-neon);
            border: 2px solid var(--main-neon);
            margin-top: 20px;
        }
        #new-game-btn:hover {
            background-color: var(--main-neon);
            color: var(--dark-bg);
            box-shadow: 0 0 15px var(--main-neon);
        }

        /* --- HESAP MAKƒ∞NESƒ∞ (Panel) --- */
        .calculator-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--dark-bg);
            border: 2px solid var(--secondary-neon);
            box-shadow: 0 0 30px var(--secondary-neon);
            border-radius: 6px;
            z-index: 1000;
            width: 340px; /* Panel geni≈ületildi */
            padding-bottom: 15px;
        }
        
        #calc-data-set {
            background-color: rgba(255, 255, 255, 0.05);
            padding: 10px;
            margin: 10px 15px;
            border: 1px dashed var(--danger-neon);
            font-size: 1em;
            color: var(--danger-neon);
            text-shadow: 0 0 3px var(--danger-neon);
            max-height: 100px;
            overflow-y: auto; /* √áok veri varsa kaydƒ±rma √ßubuƒüu √ßƒ±ksƒ±n */
        }
        
        .calc-header {
            background-color: #111;
            padding: 10px;
            font-weight: bold;
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
            color: var(--secondary-neon);
        }
        #calc-display {
            width: calc(100% - 20px);
            margin: 10px;
            padding: 15px 10px;
            font-size: 1.5em;
            font-family: 'Roboto Mono', monospace;
            text-align: right;
            background-color: #000;
            color: var(--font-color);
            border: 1px solid var(--secondary-neon);
            border-radius: 4px;
        }
        .calc-keys {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 4 s√ºtunlu ƒ±zgara */
            gap: 10px;
            padding: 0 15px 0;
        }
        .calc-keys button {
            padding: 20px;
            font-size: 1.2em;
            font-family: 'Roboto Mono', monospace;
            border: 1px solid var(--secondary-neon);
            border-radius: 4px;
            cursor: pointer;
            background-color: rgba(0, 0, 0, 0.3);
            color: var(--secondary-neon);
            transition: all 0.2s;
        }
        .calc-keys button:hover {
            background-color: var(--secondary-neon);
            color: var(--dark-bg);
            box-shadow: 0 0 10px var(--secondary-neon);
        }
        .calc-keys .key-op {
            color: var(--accent-neon);
            border-color: var(--accent-neon);
        }
        .calc-keys .key-op:hover {
            background-color: var(--accent-neon);
            color: var(--dark-bg);
        }
        .key-confirm {
            grid-column: span 4; /* Onayla butonu 4 s√ºtunu da kaplayacak */
            background-color: var(--main-neon);
            color: var(--dark-bg);
            border: none;
        }
        .key-confirm:hover {
            background-color: var(--accent-neon);
            border-color: var(--accent-neon);
            box-shadow: 0 0 15px var(--accent-neon);
        }

        /* --- GERƒ∞ Bƒ∞LDƒ∞Rƒ∞M VE YENƒ∞ G√ñREV --- */
        #feedback-area {
            margin-top: 20px;
            font-size: 1.1em;
            font-weight: bold;
            padding: 15px;
            border-radius: 4px;
            text-shadow: 0 0 5px currentColor;
        }
        .feedback-correct {
            background-color: rgba(51, 204, 255, 0.1);
            color: var(--success-neon);
            border: 1px solid var(--success-neon);
        }
        .feedback-wrong {
            background-color: rgba(255, 50, 50, 0.1);
            color: var(--danger-neon);
            border: 1px solid var(--danger-neon);
        }
    </style>
</head>
<body>

    <div class="game-container">
        <h2>Aritmetik Ortalama Macerasƒ±</h2>

        <div class="story-box">
            <p id="story-text">Y√ºkleniyor...</p>
            <div id="data-set"></div> 
        </div>

        <div class="formula-section">
            <div class="formula-title">Temel A.O. Hesaplama</div>
            <div class="formula-board">
                <span class="formula-label">A.O =</span>
                <div class="fraction">
                    <input type="text" id="input-vt" class="formula-input" placeholder="V.T'yi Hesapla" readonly>
                    <div class="fraction-line"></div>
                    <input type="number" id="input-vs" class="formula-input" placeholder="V.S'yi Gir">
                </div>
            </div>
        </div>

        <div class="formula-section">
             <div class="formula-title">Ters Hesaplama (Kayƒ±p Veri)</div>
            
            <div class="formula-row">
                <input type="text" id="input-vt-calc" class="formula-input" placeholder="V.T Giri≈üi" readonly>
                <span>=</span>
                <input type="text" id="input-ao-vt" class="formula-input" placeholder="A.O Giri≈üi" readonly>
                <span>x</span>
                <input type="number" id="input-vs-vt" class="formula-input" placeholder="V.S Giri≈üi">
            </div>
            
            <div class="formula-row">
                <input type="number" id="input-vs-calc" class="formula-input" placeholder="V.S Giri≈üi">
                <span>=</span>
                <input type="text" id="input-vt-vs" class="formula-input" placeholder="V.T Giri≈üi" readonly>
                <span>/</span>
                <input type="number" id="input-ao-vs" class="formula-input" placeholder="A.O Giri≈üi">
            </div>
        </div>


        <button id="calculate-btn">Hesapla</button>

        <div id="feedback-area"></div>

        <button id="new-game-btn">Yeni G√∂rev</button>
    </div>

    <div class="calculator-popup" id="calculator">
        <div class="calc-header">Hesaplayƒ±cƒ± (V.T. ve Diƒüer ƒ∞≈ülemler)</div>
        
        <div id="calc-data-set"></div>

        <input type="text" id="calc-display" readonly>
        <div class="calc-keys">
            <button class="key-op" onclick="appendToDisplay('+')">+</button>
            <button class="key-op" onclick="appendToDisplay('-')">-</button>
            <button class="key-op" onclick="appendToDisplay('*')">x</button>
            <button class="key-op" onclick="appendToDisplay('/')">√∑</button>

            <button onclick="appendToDisplay('7')">7</button>
            <button onclick="appendToDisplay('8')">8</button>
            <button onclick="appendToDisplay('9')">9</button>
            <button onclick="appendToDisplay('(')">(</button>
            
            <button onclick="appendToDisplay('4')">4</button>
            <button onclick="appendToDisplay('5')">5</button>
            <button onclick="appendToDisplay('6')">6</button>
            <button onclick="appendToDisplay(')')">)</button>
            
            <button onclick="appendToDisplay('1')">1</button>
            <button onclick="appendToDisplay('2')">2</button>
            <button onclick="appendToDisplay('3')">3</button>
            <button onclick="appendToDisplay('.')">.</button>
            
            <button class="key-op" onclick="clearDisplay()">Sil</button>
            <button onclick="appendToDisplay('0')">0</button>
            <button class="key-op" onclick="calculateResult()">=</button>
            <button class="key-op" onclick="clearAll()">C</button>
            
            <button class="key-confirm" onclick="confirmVT()">Sonucu Giri≈üe Yansƒ±t</button>
        </div>
    </div>

    <script>
        // --- OYUN VERƒ∞LERƒ∞ ---
        const gameData = [
             // Tip 1: Klasik A.O. Hesaplama (3 Senaryo)
            {
                type: 1,
                story: "Sincap √áƒ±t√ßƒ±t, 5 g√ºn boyunca kƒ±≈ü i√ßin ceviz topladƒ±. G√ºnl√ºk topladƒ±ƒüƒ± ceviz sayƒ±larƒ±:",
                data: [12, 10, 15, 8, 20],
                answerType: 'AO'
            },
            {
                type: 1,
                story: "Basketbolcu Efe, son 4 ma√ßta ≈üu sayƒ±larƒ± attƒ±:",
                data: [22, 18, 25, 19],
                answerType: 'AO'
            },
            {
                type: 1,
                story: "Bir haftalƒ±k (7 g√ºn) hava sƒ±caklƒ±klarƒ± (¬∞C) ≈ü√∂yle √∂l√ß√ºld√º:",
                data: [24, 26, 23, 25, 22, 27, 26],
                answerType: 'AO'
            },
            // Tip 2: Kayƒ±p Veri Bulma (V.T. = A.O x V.S. ile Kayƒ±p Deƒüer Bulma) - 2 Senaryo
            {
                type: 2,
                // Kayƒ±p ki≈üi ya≈ü: (5 * 24) - (4 * 20) = 120 - 80 = 40
                story: "4 ki≈üilik turist kafilesinin ya≈ü ortalamasƒ± **20**'dir. Gruba sonradan bir ki≈üi daha katƒ±ldƒ± ve grubun yeni ya≈ü ortalamasƒ± **24** oldu. Son katƒ±lan ki≈üi ka√ß ya≈üƒ±ndadƒ±r?",
                formulaNeeded: 'VT',
                data: {
                    vt1: 4 * 20, // ƒ∞lk grubun V.T'si
                    vs1: 4,      // ƒ∞lk grubun V.S'si
                    ao2: 24,     // Yeni grubun A.O'su
                    vs2: 5       // Yeni grubun V.S'si
                },
                question: 'Son katƒ±lan ki≈üinin ya≈üƒ±nƒ±',
                correctAO: 40 
            },
            {
                type: 2,
                // Yanlƒ±≈ü okunan not: (5 * 80) - (4 * 70) = 400 - 280 = 120
                story: "5 ki≈üilik arkada≈ü grubunun matematikten son yazƒ±lƒ±dan aldƒ±klarƒ± notlarƒ±n ortalamasƒ± **80**'dir. Bu gruptan birinin yazƒ±lƒ± kaƒüƒ±dƒ±nƒ±n yanlƒ±≈ü okunduƒüu anla≈üƒ±ldƒ± ve **kalan 4** √∂ƒürencinin ortalamasƒ±nƒ±n **70** olduƒüu g√∂r√ºld√º. Buna g√∂re, kaƒüƒ±dƒ± yanlƒ±≈ü okunan √∂ƒürencinin notu ka√ß olmalƒ±dƒ±r?",
                formulaNeeded: 'VT',
                data: {
                    vt1: 5 * 80, // ƒ∞lk grubun V.T'si
                    vs1: 5,
                    ao2: 70, // Kalanlarƒ±n A.O'su
                    vs2: 4   // Kalanlarƒ±n V.S'si
                },
                question: 'Kaƒüƒ±dƒ± yanlƒ±≈ü okunan √∂ƒürencinin notunu',
                correctAO: 120
            },
             // Tip 2: Kayƒ±p Veri Bulma (V.S. = V.T. / A.O. ile Veri Sayƒ±sƒ± Bulma) - YENƒ∞ 4 Senaryo
            {
                type: 2,
                // ƒ∞≈ü√ßi sayƒ±sƒ±: 5000 / 100 = 50
                story: "Bir fabrikadaki i≈ü√ßilerin g√ºnl√ºk ortalama √ºretimi **100** birimdir. Fabrikadaki toplam √ºretim **5000** birim olduƒüuna g√∂re, fabrikada ka√ß i≈ü√ßi (V.S.) √ßalƒ±≈ümaktadƒ±r?",
                formulaNeeded: 'VS',
                data: {
                    vt: 5000,
                    ao: 100
                },
                question: '√áalƒ±≈üan i≈ü√ßi sayƒ±sƒ±nƒ± (V.S.)',
                correctAO: 50 
            },
            {
                type: 2,
                // Okunan G√ºn Sayƒ±sƒ±: 350 / 70 = 5
                story: "Bir √∂ƒürencinin birka√ß g√ºnde okuduƒüu toplam sayfa sayƒ±sƒ± **350**'dir. Bu √∂ƒürencinin g√ºnl√ºk okuduƒüu ortalama sayfa sayƒ±sƒ± **70** sayfa ise, √∂ƒürenci ka√ß g√ºn (V.S.) kitap okumu≈ütur?",
                formulaNeeded: 'VS',
                data: {
                    vt: 350,
                    ao: 70
                },
                question: 'Kitap okuduƒüu g√ºn sayƒ±sƒ±nƒ± (V.S.)',
                correctAO: 5 
            },
            {
                type: 2,
                // Ma√ß Sayƒ±sƒ±: 100 / 25 = 4
                story: "Bir futbolcunun attƒ±ƒüƒ± toplam gol sayƒ±sƒ± **100**'d√ºr. Ma√ß ba≈üƒ±na d√º≈üen ortalama gol sayƒ±sƒ± **25** olduƒüuna g√∂re, futbolcu ka√ß ma√ß (V.S.) oynamƒ±≈ütƒ±r?",
                formulaNeeded: 'VS',
                data: {
                    vt: 100,
                    ao: 25
                },
                question: 'Oynadƒ±ƒüƒ± ma√ß sayƒ±sƒ±nƒ± (V.S.)',
                correctAO: 4 
            },
            {
                type: 2,
                // G√ºnl√ºk Satƒ±≈ü Adedi: 1200 / 60 = 20
                story: "Bir maƒüazanƒ±n bir ayda sattƒ±ƒüƒ± toplam ti≈ü√∂rt sayƒ±sƒ± **1200** adettir. Maƒüazanƒ±n g√ºnl√ºk ortalama ti≈ü√∂rt satƒ±≈üƒ± **60** adet olduƒüuna g√∂re, ka√ß g√ºn (V.S.) satƒ±≈ü yapmƒ±≈ütƒ±r? (1 ay 30 g√ºn kabul edin.)",
                formulaNeeded: 'VS',
                data: {
                    vt: 1200,
                    ao: 60
                },
                question: 'Satƒ±≈ü yaptƒ±ƒüƒ± g√ºn sayƒ±sƒ±nƒ± (V.S.)',
                correctAO: 20 
            }
        ];

        let currentProblem = {};
        let activeInputId = null; // Hangi inputun hesap makinesini a√ßtƒ±ƒüƒ±nƒ± takip eder

        // --- HTML ELEMENTLERƒ∞Nƒ∞ SE√áME ---
        const storyText = document.getElementById('story-text');
        const dataSetText = document.getElementById('data-set');
        
        // Tip 1 alanlarƒ±
        const inputVT = document.getElementById('input-vt');
        const inputVS = document.getElementById('input-vs');
        
        // Tip 2 alanlarƒ± (V.T. = A.O x V.S)
        const inputVTCalc = document.getElementById('input-vt-calc');
        const inputAOVt = document.getElementById('input-ao-vt');
        const inputVSVt = document.getElementById('input-vs-vt');
        
        // Tip 2 alanlarƒ± (V.S. = V.T / A.O)
        const inputVSCalc = document.getElementById('input-vs-calc');
        const inputVTVs = document.getElementById('input-vt-vs');
        const inputAOVB = document.getElementById('input-ao-vs'); 

        const formulaSection1 = document.querySelector('.formula-section:nth-child(2)');
        const formulaSection2 = document.querySelector('.formula-section:nth-child(3)');

        const calculateBtn = document.getElementById('calculate-btn');
        const feedbackArea = document.getElementById('feedback-area');
        const newGameBtn = document.getElementById('new-game-btn');
        const calculator = document.getElementById('calculator');
        const calcDisplay = document.getElementById('calc-display');
        const calcDataSet = document.getElementById('calc-data-set');

        // --- HESAPLAMA FONKSƒ∞YONLARI ---
        function showCalculator(inputId, showData = false) {
            activeInputId = inputId;
            calcDisplay.value = '';
            
            // Veri seti g√∂sterimini y√∂net
            if (showData && currentProblem.data && Array.isArray(currentProblem.data)) {
                calcDataSet.innerText = `Veri Seti: [ ${currentProblem.data.join(', ')} ]`;
                calcDataSet.style.display = 'block';
            } else {
                calcDataSet.style.display = 'none';
            }
            
            calculator.style.display = 'block';
        }
        
        // Tip 1 VT Giri≈üi i√ßin
        inputVT.addEventListener('click', () => showCalculator('input-vt', true));
        // Tip 2 VT Giri≈üi i√ßin
        inputVTCalc.addEventListener('click', () => showCalculator('input-vt-calc', false));
        // Tip 2 AO (V.T. = AO x VS) Giri≈üi i√ßin
        inputAOVt.addEventListener('click', () => showCalculator('input-ao-vt', false));
        // Tip 2 V.T. (V.S. = V.T / AO) Giri≈üi i√ßin
        inputVTVs.addEventListener('click', () => showCalculator('input-vt-vs', false));
        
        
        function appendToDisplay(value) {
            // √áift operat√∂r girmeyi engelle (√∂rneƒüin ++ veya *+)
            const lastChar = calcDisplay.value.slice(-1);
            if (['+', '-', '*', '/'].includes(value) && ['+', '-', '*', '/'].includes(lastChar)) {
                calcDisplay.value = calcDisplay.value.slice(0, -1) + value; // Eski operat√∂r√º yeniyle deƒüi≈ütir
            } else {
                calcDisplay.value += value;
            }
        }

        function clearDisplay() {
            calcDisplay.value = calcDisplay.value.slice(0, -1); // Son karakteri sil
        }
        
        function clearAll() {
            calcDisplay.value = ''; // T√ºm√ºn√º temizle
        }
        
        function calculateResult() {
            try {
                // G√ºvenli hesaplama i√ßin eval kullanmadan √∂nce parantez, sayƒ± ve operat√∂r kontrol√º yap
                const result = new Function('return ' + calcDisplay.value.replace(/x/g, '*').replace(/√∑/g, '/'))(); // x ve √∑ i≈üaretlerini JS operat√∂rlerine d√∂n√º≈üt√ºr
                calcDisplay.value = result;
            } catch (error) {
                calcDisplay.value = 'HATA';
            }
        }

        function confirmVT() {
            calculateResult(); // Onaylamadan √∂nce sonucu hesapla

            const targetInput = document.getElementById(activeInputId);
            
            if (targetInput && calcDisplay.value !== 'HATA') {
                targetInput.value = calcDisplay.value;
            }
            calculator.style.display = 'none';
            checkInputs();
        }

        // --- OYUN MANTIƒûI ---
        function startNewGame() {
            // Rastgele bir problem se√ß
            const randomIndex = Math.floor(Math.random() * gameData.length);
            const problem = gameData[randomIndex];
            currentProblem = problem;

            // Alanlarƒ± temizle ve ba≈ülangƒ±√ß durumuna getir
            storyText.innerText = problem.story;
            feedbackArea.innerHTML = '';
            feedbackArea.className = '';
            calculateBtn.style.display = 'none';

            // T√ºm inputlarƒ± temizle
            document.querySelectorAll('.formula-input').forEach(input => input.value = '');
            
            // Senaryo tipine g√∂re form√ºl panellerini g√∂ster/gizle
            if (problem.type === 1) {
                // Tip 1: Klasik A.O.
                formulaSection1.style.display = 'block';
                formulaSection2.style.display = 'none';
                dataSetText.innerText = `[ ${problem.data.join(', ')} ]`;
            } else {
                // Tip 2: Kayƒ±p Veri Bulma
                formulaSection1.style.display = 'none';
                formulaSection2.style.display = 'block';
                dataSetText.innerText = ''; // Veri seti bu sorularda g√∂sterilmez
                
                // Form√ºl ipu√ßlarƒ±
                inputVTCalc.placeholder = problem.formulaNeeded === 'VT' ? 'ƒ∞htiyacƒ±n olan V.T.' : 'V.T Giri≈üi';
                inputVSCalc.placeholder = problem.formulaNeeded === 'VS' ? 'ƒ∞htiyacƒ±n olan V.S.' : 'V.S Giri≈üi';

                // Tip 2 Sorularƒ±nda, kullanƒ±cƒ±dan beklenen cevap hangisiyse, o input bo≈ü bƒ±rakƒ±lƒ±r. Diƒüer inputlar da temizlenir.
                // Bu senaryoda V.T. ve A.O. gibi alanlarƒ±n doldurulmasƒ±nƒ± BEKLEMƒ∞YORUZ, sadece sonucun doƒüru alana girilmesini bekliyoruz.
                // ƒ∞PUCU: Aslƒ±nda buradaki inputlar, Tip 2 sorularƒ± i√ßin bir hesap makinesi i≈ülevi g√∂r√ºyor.
            }
        }

        function checkInputs() {
            // Tip 1 kontrol
            if (currentProblem.type === 1) {
                if (inputVT.value && inputVS.value && parseFloat(inputVS.value) > 0) {
                    calculateBtn.style.display = 'block';
                    return true;
                }
            } 
            // Tip 2 kontrol (V.T = A.O x V.S) - Kayƒ±p Deƒüer Bulma
            else if (currentProblem.type === 2 && currentProblem.formulaNeeded === 'VT') {
                if (inputVTCalc.value) { // Kullanƒ±cƒ± sonucu bu alana girmeli
                    calculateBtn.style.display = 'block';
                    return true;
                }
            } 
            // Tip 2 kontrol (V.S = V.T / A.O) - Veri Sayƒ±sƒ± Bulma
            else if (currentProblem.type === 2 && currentProblem.formulaNeeded === 'VS') {
                 if (inputVSCalc.value) { // Kullanƒ±cƒ± sonucu bu alana girmeli
                    calculateBtn.style.display = 'block';
                    return true;
                 }
            }

            calculateBtn.style.display = 'none';
            return false;
        }

        function checkAnswer() {
            let userAnswer = NaN;
            
            // Tip 1: Klasik A.O. Kontrol√º
            if (currentProblem.type === 1) {
                const userVT = parseFloat(inputVT.value);
                const userVS = parseFloat(inputVS.value);
                
                const correctVT = currentProblem.data.reduce((sum, current) => sum + current, 0);
                const correctVS = currentProblem.data.length;
                const correctAO = correctVT / correctVS;
                
                if (Math.abs(userVT - correctVT) < 0.01 && Math.abs(userVS - correctVS) < 0.01) {
                    feedbackArea.className = 'feedback-correct';
                    feedbackArea.innerHTML = `üéâ TEBRƒ∞KLER! Ortalama ba≈üarƒ±yla hesaplandƒ±: **A.O = ${correctAO.toFixed(2)}**`;
                } else if (Math.abs(userVT - correctVT) >= 0.01) {
                    feedbackArea.className = 'feedback-wrong';
                    feedbackArea.innerHTML = `‚ö†Ô∏è HATA: **Verilerin Toplamƒ± (V.T)** yanlƒ±≈ü girildi. Tekrar kontrol et.`;
                } else if (Math.abs(userVS - correctVS) >= 0.01) {
                    feedbackArea.className = 'feedback-wrong';
                    feedbackArea.innerHTML = `‚ö†Ô∏è HATA: **Veri Sayƒ±sƒ± (V.S)** yanlƒ±≈ü girildi. Tekrar kontrol et.`;
                }
            } 
            
            // Tip 2: Kayƒ±p Veri Kontrol√º
            else if (currentProblem.type === 2) {
                if (currentProblem.formulaNeeded === 'VT') {
                    userAnswer = parseFloat(inputVTCalc.value); // V.T. hesaplamasƒ±
                } else if (currentProblem.formulaNeeded === 'VS') {
                    userAnswer = parseFloat(inputVSCalc.value); // V.S. hesaplamasƒ±
                }
                
                const correctFinalAnswer = currentProblem.correctAO; // Bu, kayƒ±p deƒüeri (V.S. veya V.T. farkƒ±) temsil eder
                
                if (Math.abs(userAnswer - correctFinalAnswer) < 0.01) {
                     feedbackArea.className = 'feedback-correct';
                     feedbackArea.innerHTML = `üéâ TEBRƒ∞KLER! **${currentProblem.question}** doƒüru bulundu: **${correctFinalAnswer}**`;
                } else {
                     feedbackArea.className = 'feedback-wrong';
                     feedbackArea.innerHTML = `‚ö†Ô∏è HATA: **${currentProblem.question}** yanlƒ±≈ü hesaplandƒ±. Cevabƒ±n **${correctFinalAnswer}** olmasƒ± gerekiyordu. Form√ºlleri doƒüru kullandƒ±ƒüƒ±ndan emin ol.`;
                }
            }
        }

        // --- OLAY Dƒ∞NLEYƒ∞Cƒ∞LER (EVENT LISTENERS) ---
        // Tip 1 VS Giri≈ü Kontrol√º
        inputVS.addEventListener('input', checkInputs);
        
        // Tip 2 input kontrol√º (Sadece hesap makinesi kullanƒ±lamayan inputlar)
        inputVSVt.addEventListener('input', checkInputs);
        inputAOVB.addEventListener('input', checkInputs);
        inputVSCalc.addEventListener('input', checkInputs); // VS bulma sonucunun girildiƒüi alan
        inputVTCalc.addEventListener('input', checkInputs); // VT bulma sonucunun girildiƒüi alan
        
        
        calculateBtn.addEventListener('click', checkAnswer);
        newGameBtn.addEventListener('click', startNewGame);

        // Sayfa ilk y√ºklendiƒüinde oyunu ba≈ülat
        startNewGame();
    </script>
</body>
</html>
